## ğŸ“… Paid Calendar App

A premium calendar application built with **Node.js** that supports **authentication**, **subscription plans**, and integrates **Stripe payments** to unlock premium features.  
Users can register, log in, manage tasks/events, and subscribe to access premium features.

---

## ğŸš€ Features

- ğŸ” **User Authentication (JWT + Refresh Tokens + Cookies)**
- ğŸ’³ **Stripe Payment Integration**
- ğŸ—“ï¸ **Task Management System**
- ğŸ† **Premium Subscription Handling**
- ğŸ“¨ **Webhook Listener for Stripe Events**
- ğŸ”„ **Token Refresh System**
- ğŸ›¡ï¸ **Middleware for Auth, Subscription Check & Error Handling**

---

## ğŸ—ï¸ Tech Stack

- **Backend:** Node.js, Express.js
- **Database:** MongoDB + Mongoose
- **Authentication:** JWT, Cookies, Bcrypt
- **Payments:** Stripe API Integration
- **Task Scheduling:** Node Cron (for future subscription handling, optional)
- **Environment Variables:** dotenv

---

## ğŸ“ Folder Structure

```
â”œâ”€â”€ controllers
â”‚   â”œâ”€â”€ authController.js
â”‚   â”œâ”€â”€ paymentController.js
â”‚   â””â”€â”€ taskController.js
â”œâ”€â”€ middleware
â”‚   â”œâ”€â”€ authentication.js
â”‚   â”œâ”€â”€ error-handler.js
â”‚   â””â”€â”€ not-found.js
â”œâ”€â”€ models
â”‚   â”œâ”€â”€ User.js
â”‚   â”œâ”€â”€ Token.js
â”‚   â””â”€â”€ Task.js
â”œâ”€â”€ routes
â”‚   â”œâ”€â”€ authRoutes.js
â”‚   â”œâ”€â”€ paymentRoutes.js
â”‚   â””â”€â”€ taskRoutes.js
â”œâ”€â”€ utils
â”‚   â”œâ”€â”€ scheduleTasks.js
â”‚   â”œâ”€â”€ createTokenUser.js
â”‚   â”œâ”€â”€ jwt.js
â”‚   â””â”€â”€ stripe.js
â”œâ”€â”€ .env
â”œâ”€â”€ .gitignore
â”œâ”€â”€ server.js
â””â”€â”€ README.md
```

---

## âš™ï¸ Setup Instructions

1. **Clone Repository**

```bash
git clone https://github.com/YOUR_USERNAME/paid-calendar-app.git
cd paid-calendar-app
```

2. **Install Dependencies**

```bash
npm install
```

3. **Environment Variables**

Create a `.env` file and add:

```
PORT=5000
MONGO_URL=your_mongodb_connection_string
JWT_SECRET=your_jwt_secret
JWT_LIFETIME=1d
REFRESH_TOKEN_LIFETIME=7d
STRIPE_SECRET_KEY=your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret
FRONTEND_URL=http://localhost:3000
```

4. **Run Server**

```bash
npm start
```

---

## ğŸ§‘â€ğŸ’» API Endpoints

### Auth Routes

| Method | Endpoint                | Description                  |
| ------ | ----------------------- | ---------------------------- |
| POST   | `/api/v1/auth/register` | Register new user            |
| POST   | `/api/v1/auth/login`    | Login user                   |
| GET    | `/api/v1/auth/logout`   | Logout user (clears cookies) |

---

### Task Routes

| Method | Endpoint                     | Description     |
| ------ | ---------------------------- | --------------- |
| GET    | `/api/v1/task`               | Get all tasks   |
| POST   | `/api/v1/task/schedule-task` | Create new task |
| GET    | `/api/v1/task/:id`           | Get Single Task |
| PATCH  | `/api/v1/task/:id`           | Update task     |
| DELETE | `/api/v1/task/:id`           | Delete task     |

> **Note:** Only accessible by authenticated & subscribed users.

---

### Payment Routes

| Method | Endpoint                          | Description                     |
| ------ | --------------------------------- | ------------------------------- |
| POST   | `/api/v1/payment/create-checkout` | Create Stripe checkout session  |
| POST   | `/api/v1/payment/webhook`         | Stripe webhook for subscription |
| GET    | `/api/v1/payment/success`         | Success page after payment      |
| GET    | `/api/v1/payment/cancel`          | Cancel page if payment fails    |

---

## ğŸ”‘ Premium Feature Access Logic

Middleware checks if:

1. User is authenticated.
2. User has an active subscription (`isPaid` flag).

If not, it returns:

```
401 Unauthorized: user must be subscribed to access this feature as it is a premium feature
```

---

## ğŸŒ Stripe Integration

- Handles one-time or recurring subscriptions.
- Stripe webhook listens to successful payments and updates the userâ€™s subscription status in MongoDB.
- Includes success & cancel pages after checkout.

---

## ğŸ› ï¸ Future Improvements

- Add **Admin Dashboard** to manage users & subscriptions.
- Integrate **email notifications**.
- Add **free trial** option for users.
- Add **frontend client (React/Next.js)** for better UI/UX.

---

## ğŸ“„ License

This project is licensed under the [MIT License](LICENSE).

---

## ğŸ™Œ Contributions

PRs & Suggestions are welcome!

---
